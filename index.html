<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>科研绘图</title>
    <link rel="shortcut icon" href="https://www.baidu.com/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://fastly.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <style>
        div {
            margin-bottom: 10px;
            text-align: center;
        }

        #numInput {
            padding: 20px;
            width: 500px;
            font-size: 20px;

        }

        #generateBtn {
            padding: 20px 20px;
            width: 200px;
            font-size: 20px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
        }

        #generateBtn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
<!-- 添加输入框和按钮 -->
<div class="content">
    <input type="number" id="numInput" placeholder="请输入新增点数（最小是1，最大是100）" min="1" max="100">
    <button id="generateBtn" onclick="generatePoints()">确定</button>
</div>
<!-- 为 ECharts 准备一个定义了宽高的 DOM -->
<div id="main" style="width: 100%;height:1000px;"></div>
<script type="text/javascript">
    var myChart = echarts.init(document.getElementById('main'), null, {renderer: 'svg'});
    var symbolSize = 10;
    var data = [
        [
            -94.85907917383821,
            9.48275862068968
        ],
        [
            -69.63209982788295,
            72.93103448275865
        ],
        [
            -52.60047332185886,
            47.58620689655173
        ],
        [
            -27.271299483648875,
            36.89655172413795
        ],
        [
            2.103958691910492,
            56.66666666666668
        ],
        [
            39.5331325301205,
            50.000000000000014
        ],
        [
            59.56863166953528,
            -8.333333333333314
        ],
        [
            83.31440947009997,
            -51.02742366563636
        ]
    ];

    function generatePoints() {
        var num = parseInt(document.getElementById('numInput').value, 10);

        for (var i = 0; i < num; i++) {
            var x = Math.random() * 200 - 100;
            var y = Math.random() * 200 - 100;
            data.push([x, y]);
        }

        myChart.setOption({
            series: [
                {
                    id: 'a',
                    data: data
                }
            ],
            graphic: echarts.util.map(data, function (item, dataIndex) {
                return {
                    type: 'circle',
                    shape: {
                        r: symbolSize / 2
                    },
                    position: myChart.convertToPixel('grid', item),
                    invisible: true,
                    draggable: true,
                    z: 100,
                    ondrag: echarts.util.curry(onPointDragging, dataIndex)
                };
            })
        });
    }

    var option = {
        xAxis: {
            min: -100,
            max: 100,
            type: 'value',
            axisLine: {onZero: false}
        },
        yAxis: {
            min: -100,
            max: 100,
            type: 'value',
            axisLine: {onZero: false}
        },
        series: [
            {
                id: 'a',
                type: 'line',
                smooth: true,
                symbolSize: symbolSize,
                data: data
            }
        ]
    };

    myChart.setOption(option);

    myChart.setOption({
        graphic: echarts.util.map(data, function (dataItem, dataIndex) {
            return {
                type: 'circle',
                shape: {
                    r: symbolSize / 2
                },
                position: myChart.convertToPixel('grid', dataItem),
                invisible: true,
                draggable: true,
                z: 100,
                ondrag: echarts.util.curry(onPointDragging, dataIndex)
            };
        })
    });

    function onPointDragging(dataIndex) {
        data[dataIndex] = myChart.convertFromPixel('grid', this.position);
        myChart.setOption({
            series: [
                {
                    id: 'a',
                    data: data
                }
            ]
        });
    }

    window.addEventListener('resize', function () {
        myChart.setOption({
            graphic: echarts.util.map(data, function (item, dataIndex) {
                return {
                    position: myChart.convertToPixel('grid', item)
                };
            })
        });
    });
</script>
</body>
</html>
